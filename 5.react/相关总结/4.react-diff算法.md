## react-diff算法

为什么react比较高效呢
因为他在dom和用户操作之间构建了一个对象（虚拟dom),
我们的操作将映射到虚拟dom中，然后react再拿着虚拟dom去操作真实dom，
这样有什么好处呢，
1. 批量更新dom，将用户一次操作造成的dom修改一次做掉。不用react的dom操作就是一个语句一个语句的修改，可能会有不必要的修改。
2. 高效的diff算法能减少页面更新的区域

虚拟dom是一个对象树和真实dom一一对应。
当状态变更时就会重新构造一棵新的dom树，然后将新树和旧树对比差异，再把差异在真实dom上修改。


### diff算法
传统diff算法遍历每个节点n^3。react n
三条策略：
1. Web UI中DOM节点跨层级的移动操作特别少，可以忽略不计。
2. 拥有相同类的两个组件将会生成相似的树形结构，拥有不同类的两个组件将会生成不同的树形结构。
3. 对于同一层级的一组子节点，它们可以通过唯一 id 进行区分

tree diff
react只对相同层级的节点进行比较，对于不同层级的节点只做创建和删除操作

component diff
对于同一类型按照tree diff的策略，不同类型则直接删除，重新创建。
<!-- 对于同一类型的组件，react允许用户通过shouldComponentUpdate()来判断之后跳过diff算法分析 -->

element diff
允许开发者对同一层级的同组子节点，添加唯一 key 进行区分，让移动代替重新创建，因为有的时候都是相同的节点仅仅是位置发生了变化，添加key避免了不必要的创建、删除操作。如果是新增的元素了一个元素，对旧集合进行循环遍历，找出新集合中没有的节点删除
准确判断出当前节点是否在旧集合中
极大地减少遍历次数

tree diff          同层级
component diff     相同类型的组件
element diff       key